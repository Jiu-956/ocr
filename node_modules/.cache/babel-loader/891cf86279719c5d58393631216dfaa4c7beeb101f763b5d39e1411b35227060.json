{"ast":null,"code":"import { mapState } from \"vuex\";\nimport * as pdfjsLib from \"pdfjs-dist\";\nexport default {\n  name: \"OcrResults\",\n  computed: {\n    ...mapState([\"uploadedFileUrl\", \"ocrResults\", \"error\"]),\n    pdfUrl() {\n      return this.uploadedFileUrl;\n    },\n    ocrText() {\n      return this.ocrResults?.text || \"\";\n    }\n  },\n  watch: {\n    pdfUrl(newUrl) {\n      if (newUrl) {\n        this.renderPdf(newUrl);\n      }\n    }\n  },\n  mounted() {\n    if (this.pdfUrl) {\n      this.renderPdf(this.pdfUrl);\n    }\n  },\n  methods: {\n    async renderPdf(url) {\n      try {\n        pdfjsLib.GlobalWorkerOptions.workerSrc = `//cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfjsLib.version}/pdf.worker.min.js`;\n        const loadingTask = pdfjsLib.getDocument(url);\n        const pdf = await loadingTask.promise;\n        const page = await pdf.getPage(1);\n        const scale = 1.5;\n        const viewport = page.getViewport({\n          scale\n        });\n        const canvas = this.$refs.pdfCanvas;\n        const context = canvas.getContext(\"2d\");\n        canvas.height = viewport.height;\n        canvas.width = viewport.width;\n        await page.render({\n          canvasContext: context,\n          viewport: viewport\n        }).promise;\n      } catch (err) {\n        console.error(\"PDF 渲染失败:\", err);\n      }\n    }\n  }\n};","map":{"version":3,"names":["mapState","pdfjsLib","name","computed","pdfUrl","uploadedFileUrl","ocrText","ocrResults","text","watch","newUrl","renderPdf","mounted","methods","url","GlobalWorkerOptions","workerSrc","version","loadingTask","getDocument","pdf","promise","page","getPage","scale","viewport","getViewport","canvas","$refs","pdfCanvas","context","getContext","height","width","render","canvasContext","err","console","error"],"sources":["D:\\OCR\\ocr\\src\\views\\Results.vue"],"sourcesContent":["<template>\r\n  <div class=\"results-container\">\r\n    <h2>OCR 识别结果</h2>\r\n\r\n    <!-- PDF 渲染区域 -->\r\n    <div v-if=\"pdfUrl\" class=\"pdf-viewer\">\r\n      <canvas ref=\"pdfCanvas\"></canvas>\r\n    </div>\r\n\r\n    <!-- OCR 文本结果 -->\r\n    <div v-if=\"ocrText\" class=\"ocr-result\">\r\n      <h3>识别的文本内容</h3>\r\n      <pre>{{ ocrText }}</pre>\r\n    </div>\r\n\r\n    <!-- 错误提示 -->\r\n    <div v-if=\"error\" class=\"error-message\">\r\n      <p>{{ error }}</p>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapState } from \"vuex\";\r\nimport * as pdfjsLib from \"pdfjs-dist\";\r\n\r\nexport default {\r\n  name: \"OcrResults\",\r\n  computed: {\r\n    ...mapState([\"uploadedFileUrl\", \"ocrResults\", \"error\"]),\r\n    pdfUrl() {\r\n      return this.uploadedFileUrl;\r\n    },\r\n    ocrText() {\r\n      return this.ocrResults?.text || \"\";\r\n    }\r\n  },\r\n  watch: {\r\n    pdfUrl(newUrl) {\r\n      if (newUrl) {\r\n        this.renderPdf(newUrl);\r\n      }\r\n    }\r\n  },\r\n  mounted() {\r\n    if (this.pdfUrl) {\r\n      this.renderPdf(this.pdfUrl);\r\n    }\r\n  },\r\n  methods: {\r\n    async renderPdf(url) {\r\n      try {\r\n        pdfjsLib.GlobalWorkerOptions.workerSrc =\r\n          `//cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfjsLib.version}/pdf.worker.min.js`;\r\n\r\n        const loadingTask = pdfjsLib.getDocument(url);\r\n        const pdf = await loadingTask.promise;\r\n\r\n        const page = await pdf.getPage(1);\r\n        const scale = 1.5;\r\n        const viewport = page.getViewport({ scale });\r\n\r\n        const canvas = this.$refs.pdfCanvas;\r\n        const context = canvas.getContext(\"2d\");\r\n        canvas.height = viewport.height;\r\n        canvas.width = viewport.width;\r\n\r\n        await page.render({\r\n          canvasContext: context,\r\n          viewport: viewport\r\n        }).promise;\r\n      } catch (err) {\r\n        console.error(\"PDF 渲染失败:\", err);\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.results-container {\r\n  padding: 20px;\r\n}\r\n\r\n.pdf-viewer {\r\n  margin-bottom: 20px;\r\n  text-align: center;\r\n}\r\n\r\n.ocr-result {\r\n  margin-top: 20px;\r\n  background: #f6f6f6;\r\n  padding: 15px;\r\n  border-radius: 8px;\r\n  font-family: monospace;\r\n  white-space: pre-wrap;\r\n}\r\n\r\n.error-message {\r\n  margin-top: 20px;\r\n  color: red;\r\n  font-weight: bold;\r\n}\r\n</style>\r\n"],"mappings":"AAuBA,SAASA,QAAO,QAAS,MAAM;AAC/B,OAAO,KAAKC,QAAO,MAAO,YAAY;AAEtC,eAAe;EACbC,IAAI,EAAE,YAAY;EAClBC,QAAQ,EAAE;IACR,GAAGH,QAAQ,CAAC,CAAC,iBAAiB,EAAE,YAAY,EAAE,OAAO,CAAC,CAAC;IACvDI,MAAMA,CAAA,EAAG;MACP,OAAO,IAAI,CAACC,eAAe;IAC7B,CAAC;IACDC,OAAOA,CAAA,EAAG;MACR,OAAO,IAAI,CAACC,UAAU,EAAEC,IAAG,IAAK,EAAE;IACpC;EACF,CAAC;EACDC,KAAK,EAAE;IACLL,MAAMA,CAACM,MAAM,EAAE;MACb,IAAIA,MAAM,EAAE;QACV,IAAI,CAACC,SAAS,CAACD,MAAM,CAAC;MACxB;IACF;EACF,CAAC;EACDE,OAAOA,CAAA,EAAG;IACR,IAAI,IAAI,CAACR,MAAM,EAAE;MACf,IAAI,CAACO,SAAS,CAAC,IAAI,CAACP,MAAM,CAAC;IAC7B;EACF,CAAC;EACDS,OAAO,EAAE;IACP,MAAMF,SAASA,CAACG,GAAG,EAAE;MACnB,IAAI;QACFb,QAAQ,CAACc,mBAAmB,CAACC,SAAQ,GACnC,2CAA2Cf,QAAQ,CAACgB,OAAO,oBAAoB;QAEjF,MAAMC,WAAU,GAAIjB,QAAQ,CAACkB,WAAW,CAACL,GAAG,CAAC;QAC7C,MAAMM,GAAE,GAAI,MAAMF,WAAW,CAACG,OAAO;QAErC,MAAMC,IAAG,GAAI,MAAMF,GAAG,CAACG,OAAO,CAAC,CAAC,CAAC;QACjC,MAAMC,KAAI,GAAI,GAAG;QACjB,MAAMC,QAAO,GAAIH,IAAI,CAACI,WAAW,CAAC;UAAEF;QAAM,CAAC,CAAC;QAE5C,MAAMG,MAAK,GAAI,IAAI,CAACC,KAAK,CAACC,SAAS;QACnC,MAAMC,OAAM,GAAIH,MAAM,CAACI,UAAU,CAAC,IAAI,CAAC;QACvCJ,MAAM,CAACK,MAAK,GAAIP,QAAQ,CAACO,MAAM;QAC/BL,MAAM,CAACM,KAAI,GAAIR,QAAQ,CAACQ,KAAK;QAE7B,MAAMX,IAAI,CAACY,MAAM,CAAC;UAChBC,aAAa,EAAEL,OAAO;UACtBL,QAAQ,EAAEA;QACZ,CAAC,CAAC,CAACJ,OAAO;MACZ,EAAE,OAAOe,GAAG,EAAE;QACZC,OAAO,CAACC,KAAK,CAAC,WAAW,EAAEF,GAAG,CAAC;MACjC;IACF;EACF;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}