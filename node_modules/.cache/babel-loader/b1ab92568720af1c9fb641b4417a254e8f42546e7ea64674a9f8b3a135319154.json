{"ast":null,"code":"import { createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode } from \"vue\";\nconst _hoisted_1 = {\n  class: \"results-container\"\n};\nconst _hoisted_2 = {\n  ref: \"pdfContainer\",\n  class: \"pdf-container\"\n};\nconst _hoisted_3 = {\n  class: \"latex-container\"\n};\nconst _hoisted_4 = [\"onMouseover\"];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createCommentVNode(\" 左侧 PDF \"), _createElementVNode(\"div\", _hoisted_2, null, 512 /* NEED_PATCH */), _createCommentVNode(\" 右侧 LaTeX \"), _createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"pre\", null, [_cache[3] || (_cache[3] = _createTextVNode(\"        \")), _createElementVNode(\"code\", null, [_cache[1] || (_cache[1] = _createTextVNode(\"\\n          \")), (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.latexLines, (line, index) => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: index,\n      class: \"latex-line\",\n      onMouseover: $event => $options.highlightPdfLine(index),\n      onMouseleave: _cache[0] || (_cache[0] = (...args) => $options.removeHighlight && $options.removeHighlight(...args))\n    }, \"\\n            \" + _toDisplayString(line) + \"\\n          \", 41 /* TEXT, PROPS, NEED_HYDRATION */, _hoisted_4);\n  }), 128 /* KEYED_FRAGMENT */)), _cache[2] || (_cache[2] = _createTextVNode(\"\\n        \"))]), _cache[4] || (_cache[4] = _createTextVNode(\"\\n      \"))])])]);\n}","map":{"version":3,"names":["class","ref","_createElementBlock","_hoisted_1","_createCommentVNode","_createElementVNode","_hoisted_2","_hoisted_3","_Fragment","_renderList","$data","latexLines","line","index","key","onMouseover","$event","$options","highlightPdfLine","onMouseleave","_cache","args","removeHighlight","_toDisplayString","_hoisted_4"],"sources":["D:\\OCR\\ocr\\src\\views\\Results.vue"],"sourcesContent":["<template>\r\n  <div class=\"results-container\">\r\n    <!-- 左侧 PDF -->\r\n    <div ref=\"pdfContainer\" class=\"pdf-container\"></div>\r\n\r\n    <!-- 右侧 LaTeX -->\r\n    <div class=\"latex-container\">\r\n      <pre>\r\n        <code>\r\n          <div\r\n            v-for=\"(line, index) in latexLines\"\r\n            :key=\"index\"\r\n            class=\"latex-line\"\r\n            @mouseover=\"highlightPdfLine(index)\"\r\n            @mouseleave=\"removeHighlight\"\r\n          >\r\n            {{ line }}\r\n          </div>\r\n        </code>\r\n      </pre>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport * as pdfjsLib from \"pdfjs-dist\";\r\n\r\nexport default {\r\n  props: {\r\n    pdfUrl: String,\r\n    latexCode: String,\r\n  },\r\n  data() {\r\n    return {\r\n      pdfDoc: null,\r\n      latexLines: [],\r\n      highlightedEl: null, // 当前高亮的PDF元素\r\n    };\r\n  },\r\n  async mounted() {\r\n    this.latexLines = this.latexCode ? this.latexCode.split(\"\\n\") : [];\r\n\r\n    if (this.pdfUrl) {\r\n      pdfjsLib.GlobalWorkerOptions.workerSrc =\r\n        \"https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js\";\r\n\r\n      this.pdfDoc = await pdfjsLib.getDocument(this.pdfUrl).promise;\r\n      this.renderAllPages();\r\n    }\r\n  },\r\n  methods: {\r\n    async renderAllPages() {\r\n      const container = this.$refs.pdfContainer;\r\n      container.innerHTML = \"\";\r\n\r\n      for (let pageNum = 1; pageNum <= this.pdfDoc.numPages; pageNum++) {\r\n        const page = await this.pdfDoc.getPage(pageNum);\r\n        const viewport = page.getViewport({ scale: 1.2 });\r\n\r\n        const canvas = document.createElement(\"canvas\");\r\n        const context = canvas.getContext(\"2d\");\r\n        canvas.height = viewport.height;\r\n        canvas.width = viewport.width;\r\n\r\n        const renderContext = {\r\n          canvasContext: context,\r\n          viewport: viewport,\r\n        };\r\n\r\n        // 渲染PDF\r\n        await page.render(renderContext).promise;\r\n\r\n        // 包一层 div 方便定位\r\n        const wrapper = document.createElement(\"div\");\r\n        wrapper.classList.add(\"pdf-page\");\r\n        wrapper.appendChild(canvas);\r\n        wrapper.setAttribute(\"data-page\", pageNum);\r\n\r\n        container.appendChild(wrapper);\r\n      }\r\n    },\r\n\r\n    highlightPdfLine(index) {\r\n      // 假设：LaTeX 行号和 PDF 页码一一对应（可按需映射）\r\n      const pageNum = Math.floor(index / 30) + 1; // 每30行LaTeX算一页\r\n      const pageEl = this.$refs.pdfContainer.querySelector(\r\n        `.pdf-page[data-page='${pageNum}']`\r\n      );\r\n\r\n      if (pageEl) {\r\n        // 滚动到目标页\r\n        pageEl.scrollIntoView({ behavior: \"smooth\", block: \"center\" });\r\n\r\n        // 去掉之前的高亮\r\n        if (this.highlightedEl) {\r\n          this.highlightedEl.classList.remove(\"highlight\");\r\n        }\r\n\r\n        // 高亮当前页\r\n        pageEl.classList.add(\"highlight\");\r\n        this.highlightedEl = pageEl;\r\n      }\r\n    },\r\n\r\n    removeHighlight() {\r\n      if (this.highlightedEl) {\r\n        this.highlightedEl.classList.remove(\"highlight\");\r\n        this.highlightedEl = null;\r\n      }\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.results-container {\r\n  display: flex;\r\n  height: 100vh;\r\n}\r\n\r\n.pdf-container {\r\n  flex: 1;\r\n  overflow-y: auto;\r\n  background: #f0f0f0;\r\n}\r\n\r\n.latex-container {\r\n  flex: 1;\r\n  padding: 10px;\r\n  background: #1e1e1e;\r\n  color: #dcdcdc;\r\n  overflow-y: auto;\r\n  font-family: monospace;\r\n}\r\n\r\n.latex-line {\r\n  padding: 2px 4px;\r\n}\r\n\r\n.latex-line:hover {\r\n  background-color: #444;\r\n  cursor: pointer;\r\n}\r\n\r\n.pdf-page.highlight {\r\n  outline: 4px solid orange;\r\n}\r\n</style>\r\n"],"mappings":";;EACOA,KAAK,EAAC;AAAmB;;EAEvBC,GAAG,EAAC,cAAc;EAACD,KAAK,EAAC;;;EAGzBA,KAAK,EAAC;AAAiB;;;uBAL9BE,mBAAA,CAoBM,OApBNC,UAoBM,GAnBJC,mBAAA,YAAe,EACfC,mBAAA,CAAoD,OAApDC,UAAoD,+BAEpDF,mBAAA,cAAiB,EACjBC,mBAAA,CAcM,OAdNE,UAcM,GAbJF,mBAAA,CAYM,c,2CAZD,UACH,IAAAA,mBAAA,CAUO,e,2CAVD,cACJ,K,kBAAAH,mBAAA,CAQMM,SAAA,QAAAC,WAAA,CAPoBC,KAAA,CAAAC,UAAU,GAA1BC,IAAI,EAAEC,KAAK;yBADrBX,mBAAA,CAQM;MANHY,GAAG,EAAED,KAAK;MACXb,KAAK,EAAC,YAAY;MACjBe,WAAS,EAAAC,MAAA,IAAEC,QAAA,CAAAC,gBAAgB,CAACL,KAAK;MACjCM,YAAU,EAAAC,MAAA,QAAAA,MAAA,UAAAC,IAAA,KAAEJ,QAAA,CAAAK,eAAA,IAAAL,QAAA,CAAAK,eAAA,IAAAD,IAAA,CAAe;OAC7B,gBACC,GAAAE,gBAAA,CAAGX,IAAI,IAAG,cACZ,wCAAAY,UAAA;6EAAM,YACR,G,8CAAO,UACT,G","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}