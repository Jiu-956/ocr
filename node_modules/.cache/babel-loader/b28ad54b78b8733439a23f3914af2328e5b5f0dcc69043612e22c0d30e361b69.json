{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { mapState } from \"vuex\";\nimport * as pdfjsLib from \"pdfjs-dist\";\n\n// 直接用 CDN 的 worker\npdfjsLib.GlobalWorkerOptions.workerSrc = `//cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfjsLib.version}/pdf.worker.min.js`;\nexport default {\n  name: \"OcrResults\",\n  computed: {\n    ...mapState([\"ocrResults\"])\n  },\n  data() {\n    return {\n      pdfDoc: null,\n      pdfPages: [],\n      latexLines: []\n    };\n  },\n  mounted() {\n    if (this.ocrResults) {\n      if (this.ocrResults.latex) {\n        this.latexLines = this.ocrResults.latex.split(\"\\n\");\n      }\n      if (this.ocrResults.pdfUrl) {\n        this.loadPDF(this.ocrResults.pdfUrl);\n      }\n    }\n  },\n  methods: {\n    async loadPDF(url) {\n      const loadingTask = pdfjsLib.getDocument(url);\n      this.pdfDoc = await loadingTask.promise;\n      const numPages = this.pdfDoc.numPages;\n      for (let i = 1; i <= numPages; i++) {\n        const page = await this.pdfDoc.getPage(i);\n        this.pdfPages.push(page);\n        this.renderPage(i, page);\n      }\n    },\n    async renderPage(pageNum, page) {\n      const container = this.$refs[\"page-\" + (pageNum - 1)][0];\n      const viewport = page.getViewport({\n        scale: 1.2\n      });\n      const canvas = document.createElement(\"canvas\");\n      canvas.width = viewport.width;\n      canvas.height = viewport.height;\n      container.appendChild(canvas);\n      const context = canvas.getContext(\"2d\");\n      const renderContext = {\n        canvasContext: context,\n        viewport: viewport\n      };\n      await page.render(renderContext).promise;\n    },\n    scrollToPage(index) {\n      const pageEl = this.$refs[\"page-\" + index]?.[0];\n      const container = this.$refs.pdfContainer;\n      if (pageEl) {\n        container.scrollTop = pageEl.offsetTop;\n        pageEl.style.border = \"2px solid red\";\n      }\n    },\n    clearHighlight(index) {\n      const pageEl = this.$refs[\"page-\" + index]?.[0];\n      if (pageEl) {\n        pageEl.style.border = \"none\";\n      }\n    },\n    goBack() {\n      this.$store.commit(\"resetState\");\n      this.$router.push(\"/\");\n    }\n  }\n};","map":{"version":3,"names":["mapState","pdfjsLib","GlobalWorkerOptions","workerSrc","version","name","computed","data","pdfDoc","pdfPages","latexLines","mounted","ocrResults","latex","split","pdfUrl","loadPDF","methods","url","loadingTask","getDocument","promise","numPages","i","page","getPage","push","renderPage","pageNum","container","$refs","viewport","getViewport","scale","canvas","document","createElement","width","height","appendChild","context","getContext","renderContext","canvasContext","render","scrollToPage","index","pageEl","pdfContainer","scrollTop","offsetTop","style","border","clearHighlight","goBack","$store","commit","$router"],"sources":["D:\\OCR\\ocr\\src\\views\\Results.vue"],"sourcesContent":["<template>\r\n  <div class=\"results\">\r\n    <h2>OCR Results</h2>\r\n\r\n    <div v-if=\"ocrResults\" class=\"results-container\">\r\n      <!-- 左侧 PDF 区域 -->\r\n      <div class=\"pdf-container\" ref=\"pdfContainer\">\r\n        <div\r\n          v-for=\"(page, index) in pdfPages\"\r\n          :key=\"index\"\r\n          class=\"pdf-page\"\r\n          :ref=\"'page-' + index\"\r\n        ></div>\r\n      </div>\r\n\r\n      <!-- 右侧 Nougat 输出的 LaTeX -->\r\n      <div class=\"latex-container\">\r\n        <h3>Nougat LaTeX 输出：</h3>\r\n        <div\r\n          v-for=\"(line, index) in latexLines\"\r\n          :key=\"index\"\r\n          class=\"latex-line\"\r\n          @mouseenter=\"scrollToPage(index)\"\r\n          @mouseleave=\"clearHighlight(index)\"\r\n        >\r\n          {{ line }}\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <div v-else class=\"no-results\">\r\n      <p>No results to display.</p>\r\n    </div>\r\n\r\n    <button @click=\"goBack\" class=\"back-button\">Process Another File</button>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapState } from \"vuex\";\r\nimport * as pdfjsLib from \"pdfjs-dist\";\r\n\r\n// 直接用 CDN 的 worker\r\npdfjsLib.GlobalWorkerOptions.workerSrc = `//cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfjsLib.version}/pdf.worker.min.js`;\r\n\r\nexport default {\r\n  name: \"OcrResults\",\r\n  computed: {\r\n    ...mapState([\"ocrResults\"]),\r\n  },\r\n  data() {\r\n    return {\r\n      pdfDoc: null,\r\n      pdfPages: [],\r\n      latexLines: [],\r\n    };\r\n  },\r\n  mounted() {\r\n    if (this.ocrResults) {\r\n      if (this.ocrResults.latex) {\r\n        this.latexLines = this.ocrResults.latex.split(\"\\n\");\r\n      }\r\n      if (this.ocrResults.pdfUrl) {\r\n        this.loadPDF(this.ocrResults.pdfUrl);\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    async loadPDF(url) {\r\n      const loadingTask = pdfjsLib.getDocument(url);\r\n      this.pdfDoc = await loadingTask.promise;\r\n      const numPages = this.pdfDoc.numPages;\r\n\r\n      for (let i = 1; i <= numPages; i++) {\r\n        const page = await this.pdfDoc.getPage(i);\r\n        this.pdfPages.push(page);\r\n        this.renderPage(i, page);\r\n      }\r\n    },\r\n    async renderPage(pageNum, page) {\r\n      const container = this.$refs[\"page-\" + (pageNum - 1)][0];\r\n      const viewport = page.getViewport({ scale: 1.2 });\r\n      const canvas = document.createElement(\"canvas\");\r\n      canvas.width = viewport.width;\r\n      canvas.height = viewport.height;\r\n      container.appendChild(canvas);\r\n\r\n      const context = canvas.getContext(\"2d\");\r\n      const renderContext = { canvasContext: context, viewport: viewport };\r\n      await page.render(renderContext).promise;\r\n    },\r\n    scrollToPage(index) {\r\n      const pageEl = this.$refs[\"page-\" + index]?.[0];\r\n      const container = this.$refs.pdfContainer;\r\n\r\n      if (pageEl) {\r\n        container.scrollTop = pageEl.offsetTop;\r\n        pageEl.style.border = \"2px solid red\";\r\n      }\r\n    },\r\n    clearHighlight(index) {\r\n      const pageEl = this.$refs[\"page-\" + index]?.[0];\r\n      if (pageEl) {\r\n        pageEl.style.border = \"none\";\r\n      }\r\n    },\r\n    goBack() {\r\n      this.$store.commit(\"resetState\");\r\n      this.$router.push(\"/\");\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n\r\n\r\n<style scoped>\r\n.results-container {\r\n  display: flex;\r\n  gap: 20px;\r\n  margin: 2rem 0;\r\n  height: 80vh;\r\n}\r\n\r\n/* 左侧 PDF */\r\n.pdf-container {\r\n  flex: 1;\r\n  overflow-y: auto;\r\n  background: #eee;\r\n  padding: 10px;\r\n  border-radius: 6px;\r\n}\r\n.pdf-page {\r\n  margin-bottom: 10px;\r\n  position: relative;\r\n}\r\n\r\n/* 右侧 LaTeX */\r\n.latex-container {\r\n  flex: 1;\r\n  overflow-y: auto;\r\n  padding: 10px;\r\n  background: #f9f9f9;\r\n  border-radius: 6px;\r\n  border-left: 1px solid #ccc;\r\n}\r\n.latex-line {\r\n  padding: 5px;\r\n  cursor: pointer;\r\n}\r\n.latex-line:hover {\r\n  background-color: #d3f3ff;\r\n}\r\n\r\n.no-results {\r\n  margin: 2rem 0;\r\n  color: #666;\r\n}\r\n.back-button {\r\n  margin-top: 2rem;\r\n  background-color: #42b983;\r\n  color: white;\r\n  border: none;\r\n  padding: 0.75rem 1.5rem;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n  font-size: 1rem;\r\n}\r\n.back-button:hover {\r\n  background-color: #3aa876;\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}