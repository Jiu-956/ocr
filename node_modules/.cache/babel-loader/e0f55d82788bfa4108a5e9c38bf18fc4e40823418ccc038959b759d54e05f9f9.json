{"ast":null,"code":"import * as pdfjsLib from \"pdfjs-dist\";\nexport default {\n  props: {\n    pdfUrl: String,\n    latexCode: String\n  },\n  data() {\n    return {\n      pdfDoc: null,\n      latexLines: [],\n      highlightedEl: null // 当前高亮的PDF元素\n    };\n  },\n  async mounted() {\n    this.latexLines = this.latexCode ? this.latexCode.split(\"\\n\") : [];\n    if (this.pdfUrl) {\n      pdfjsLib.GlobalWorkerOptions.workerSrc = \"https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js\";\n      this.pdfDoc = await pdfjsLib.getDocument(this.pdfUrl).promise;\n      this.renderAllPages();\n    }\n  },\n  methods: {\n    async renderAllPages() {\n      const container = this.$refs.pdfContainer;\n      container.innerHTML = \"\";\n      for (let pageNum = 1; pageNum <= this.pdfDoc.numPages; pageNum++) {\n        const page = await this.pdfDoc.getPage(pageNum);\n        const viewport = page.getViewport({\n          scale: 1.2\n        });\n        const canvas = document.createElement(\"canvas\");\n        const context = canvas.getContext(\"2d\");\n        canvas.height = viewport.height;\n        canvas.width = viewport.width;\n        const renderContext = {\n          canvasContext: context,\n          viewport: viewport\n        };\n\n        // 渲染PDF\n        await page.render(renderContext).promise;\n\n        // 包一层 div 方便定位\n        const wrapper = document.createElement(\"div\");\n        wrapper.classList.add(\"pdf-page\");\n        wrapper.appendChild(canvas);\n        wrapper.setAttribute(\"data-page\", pageNum);\n        container.appendChild(wrapper);\n      }\n    },\n    highlightPdfLine(index) {\n      // 假设：LaTeX 行号和 PDF 页码一一对应（可按需映射）\n      const pageNum = Math.floor(index / 30) + 1; // 每30行LaTeX算一页\n      const pageEl = this.$refs.pdfContainer.querySelector(`.pdf-page[data-page='${pageNum}']`);\n      if (pageEl) {\n        // 滚动到目标页\n        pageEl.scrollIntoView({\n          behavior: \"smooth\",\n          block: \"center\"\n        });\n\n        // 去掉之前的高亮\n        if (this.highlightedEl) {\n          this.highlightedEl.classList.remove(\"highlight\");\n        }\n\n        // 高亮当前页\n        pageEl.classList.add(\"highlight\");\n        this.highlightedEl = pageEl;\n      }\n    },\n    removeHighlight() {\n      if (this.highlightedEl) {\n        this.highlightedEl.classList.remove(\"highlight\");\n        this.highlightedEl = null;\n      }\n    }\n  }\n};","map":{"version":3,"names":["pdfjsLib","props","pdfUrl","String","latexCode","data","pdfDoc","latexLines","highlightedEl","mounted","split","GlobalWorkerOptions","workerSrc","getDocument","promise","renderAllPages","methods","container","$refs","pdfContainer","innerHTML","pageNum","numPages","page","getPage","viewport","getViewport","scale","canvas","document","createElement","context","getContext","height","width","renderContext","canvasContext","render","wrapper","classList","add","appendChild","setAttribute","highlightPdfLine","index","Math","floor","pageEl","querySelector","scrollIntoView","behavior","block","remove","removeHighlight"],"sources":["D:\\OCR\\ocr\\src\\views\\Results.vue"],"sourcesContent":["<template>\r\n  <div class=\"results-container\">\r\n    <!-- 左侧 PDF -->\r\n    <div ref=\"pdfContainer\" class=\"pdf-container\"></div>\r\n\r\n    <!-- 右侧 LaTeX -->\r\n    <div class=\"latex-container\">\r\n      <pre>\r\n        <code>\r\n          <div\r\n            v-for=\"(line, index) in latexLines\"\r\n            :key=\"index\"\r\n            class=\"latex-line\"\r\n            @mouseover=\"highlightPdfLine(index)\"\r\n            @mouseleave=\"removeHighlight\"\r\n          >\r\n            {{ line }}\r\n          </div>\r\n        </code>\r\n      </pre>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport * as pdfjsLib from \"pdfjs-dist\";\r\n\r\nexport default {\r\n  props: {\r\n    pdfUrl: String,\r\n    latexCode: String,\r\n  },\r\n  data() {\r\n    return {\r\n      pdfDoc: null,\r\n      latexLines: [],\r\n      highlightedEl: null, // 当前高亮的PDF元素\r\n    };\r\n  },\r\n  async mounted() {\r\n    this.latexLines = this.latexCode ? this.latexCode.split(\"\\n\") : [];\r\n\r\n    if (this.pdfUrl) {\r\n      pdfjsLib.GlobalWorkerOptions.workerSrc =\r\n        \"https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js\";\r\n\r\n      this.pdfDoc = await pdfjsLib.getDocument(this.pdfUrl).promise;\r\n      this.renderAllPages();\r\n    }\r\n  },\r\n  methods: {\r\n    async renderAllPages() {\r\n      const container = this.$refs.pdfContainer;\r\n      container.innerHTML = \"\";\r\n\r\n      for (let pageNum = 1; pageNum <= this.pdfDoc.numPages; pageNum++) {\r\n        const page = await this.pdfDoc.getPage(pageNum);\r\n        const viewport = page.getViewport({ scale: 1.2 });\r\n\r\n        const canvas = document.createElement(\"canvas\");\r\n        const context = canvas.getContext(\"2d\");\r\n        canvas.height = viewport.height;\r\n        canvas.width = viewport.width;\r\n\r\n        const renderContext = {\r\n          canvasContext: context,\r\n          viewport: viewport,\r\n        };\r\n\r\n        // 渲染PDF\r\n        await page.render(renderContext).promise;\r\n\r\n        // 包一层 div 方便定位\r\n        const wrapper = document.createElement(\"div\");\r\n        wrapper.classList.add(\"pdf-page\");\r\n        wrapper.appendChild(canvas);\r\n        wrapper.setAttribute(\"data-page\", pageNum);\r\n\r\n        container.appendChild(wrapper);\r\n      }\r\n    },\r\n\r\n    highlightPdfLine(index) {\r\n      // 假设：LaTeX 行号和 PDF 页码一一对应（可按需映射）\r\n      const pageNum = Math.floor(index / 30) + 1; // 每30行LaTeX算一页\r\n      const pageEl = this.$refs.pdfContainer.querySelector(\r\n        `.pdf-page[data-page='${pageNum}']`\r\n      );\r\n\r\n      if (pageEl) {\r\n        // 滚动到目标页\r\n        pageEl.scrollIntoView({ behavior: \"smooth\", block: \"center\" });\r\n\r\n        // 去掉之前的高亮\r\n        if (this.highlightedEl) {\r\n          this.highlightedEl.classList.remove(\"highlight\");\r\n        }\r\n\r\n        // 高亮当前页\r\n        pageEl.classList.add(\"highlight\");\r\n        this.highlightedEl = pageEl;\r\n      }\r\n    },\r\n\r\n    removeHighlight() {\r\n      if (this.highlightedEl) {\r\n        this.highlightedEl.classList.remove(\"highlight\");\r\n        this.highlightedEl = null;\r\n      }\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.results-container {\r\n  display: flex;\r\n  height: 100vh;\r\n}\r\n\r\n.pdf-container {\r\n  flex: 1;\r\n  overflow-y: auto;\r\n  background: #f0f0f0;\r\n}\r\n\r\n.latex-container {\r\n  flex: 1;\r\n  padding: 10px;\r\n  background: #1e1e1e;\r\n  color: #dcdcdc;\r\n  overflow-y: auto;\r\n  font-family: monospace;\r\n}\r\n\r\n.latex-line {\r\n  padding: 2px 4px;\r\n}\r\n\r\n.latex-line:hover {\r\n  background-color: #444;\r\n  cursor: pointer;\r\n}\r\n\r\n.pdf-page.highlight {\r\n  outline: 4px solid orange;\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}