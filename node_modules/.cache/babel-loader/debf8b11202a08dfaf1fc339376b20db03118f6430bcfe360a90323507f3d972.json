{"ast":null,"code":"import { createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString } from \"vue\";\nconst _hoisted_1 = {\n  class: \"results-container\"\n};\nconst _hoisted_2 = {\n  key: 0,\n  class: \"pdf-viewer\"\n};\nconst _hoisted_3 = {\n  ref: \"pdfCanvas\"\n};\nconst _hoisted_4 = {\n  key: 1,\n  class: \"ocr-result\"\n};\nconst _hoisted_5 = {\n  key: 2,\n  class: \"error-message\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_cache[1] || (_cache[1] = _createElementVNode(\"h2\", null, \"OCR 识别结果\", -1 /* CACHED */)), _createCommentVNode(\" PDF 渲染区域 \"), $options.pdfUrl ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [_createElementVNode(\"canvas\", _hoisted_3, null, 512 /* NEED_PATCH */)])) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" OCR 文本结果 \"), $options.ocrText ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [_cache[0] || (_cache[0] = _createElementVNode(\"h3\", null, \"识别的文本内容\", -1 /* CACHED */)), _createElementVNode(\"pre\", null, _toDisplayString($options.ocrText), 1 /* TEXT */)])) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" 错误提示 \"), _ctx.error ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [_createElementVNode(\"p\", null, _toDisplayString(_ctx.error), 1 /* TEXT */)])) : _createCommentVNode(\"v-if\", true)]);\n}","map":{"version":3,"names":["class","ref","_createElementBlock","_hoisted_1","_createElementVNode","_createCommentVNode","$options","pdfUrl","_hoisted_2","_hoisted_3","ocrText","_hoisted_4","_toDisplayString","_ctx","error","_hoisted_5"],"sources":["D:\\OCR\\ocr\\src\\views\\Results.vue"],"sourcesContent":["<template>\r\n  <div class=\"results-container\">\r\n    <h2>OCR 识别结果</h2>\r\n\r\n    <!-- PDF 渲染区域 -->\r\n    <div v-if=\"pdfUrl\" class=\"pdf-viewer\">\r\n      <canvas ref=\"pdfCanvas\"></canvas>\r\n    </div>\r\n\r\n    <!-- OCR 文本结果 -->\r\n    <div v-if=\"ocrText\" class=\"ocr-result\">\r\n      <h3>识别的文本内容</h3>\r\n      <pre>{{ ocrText }}</pre>\r\n    </div>\r\n\r\n    <!-- 错误提示 -->\r\n    <div v-if=\"error\" class=\"error-message\">\r\n      <p>{{ error }}</p>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapState } from \"vuex\";\r\nimport * as pdfjsLib from \"pdfjs-dist\";\r\n\r\nexport default {\r\n  name: \"OcrResults\",\r\n  computed: {\r\n    ...mapState([\"uploadedFileUrl\", \"ocrResults\", \"error\"]),\r\n    pdfUrl() {\r\n      return this.uploadedFileUrl;\r\n    },\r\n    ocrText() {\r\n      return this.ocrResults?.text || \"\";\r\n    }\r\n  },\r\n  watch: {\r\n    pdfUrl(newUrl) {\r\n      if (newUrl) {\r\n        this.renderPdf(newUrl);\r\n      }\r\n    }\r\n  },\r\n  mounted() {\r\n    if (this.pdfUrl) {\r\n      this.renderPdf(this.pdfUrl);\r\n    }\r\n  },\r\n  methods: {\r\n    async renderPdf(url) {\r\n      try {\r\n        pdfjsLib.GlobalWorkerOptions.workerSrc =\r\n          `//cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfjsLib.version}/pdf.worker.min.js`;\r\n\r\n        const loadingTask = pdfjsLib.getDocument(url);\r\n        const pdf = await loadingTask.promise;\r\n\r\n        const page = await pdf.getPage(1);\r\n        const scale = 1.5;\r\n        const viewport = page.getViewport({ scale });\r\n\r\n        const canvas = this.$refs.pdfCanvas;\r\n        const context = canvas.getContext(\"2d\");\r\n        canvas.height = viewport.height;\r\n        canvas.width = viewport.width;\r\n\r\n        await page.render({\r\n          canvasContext: context,\r\n          viewport: viewport\r\n        }).promise;\r\n      } catch (err) {\r\n        console.error(\"PDF 渲染失败:\", err);\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.results-container {\r\n  padding: 20px;\r\n}\r\n\r\n.pdf-viewer {\r\n  margin-bottom: 20px;\r\n  text-align: center;\r\n}\r\n\r\n.ocr-result {\r\n  margin-top: 20px;\r\n  background: #f6f6f6;\r\n  padding: 15px;\r\n  border-radius: 8px;\r\n  font-family: monospace;\r\n  white-space: pre-wrap;\r\n}\r\n\r\n.error-message {\r\n  margin-top: 20px;\r\n  color: red;\r\n  font-weight: bold;\r\n}\r\n</style>\r\n"],"mappings":";;EACOA,KAAK,EAAC;AAAmB;;;EAITA,KAAK,EAAC;;;EACfC,GAAG,EAAC;AAAW;;;EAILD,KAAK,EAAC;;;;EAMRA,KAAK,EAAC;;;uBAf1BE,mBAAA,CAkBM,OAlBNC,UAkBM,G,0BAjBJC,mBAAA,CAAiB,YAAb,UAAQ,qBAEZC,mBAAA,cAAiB,EACNC,QAAA,CAAAC,MAAM,I,cAAjBL,mBAAA,CAEM,OAFNM,UAEM,GADJJ,mBAAA,CAAiC,UAAjCK,UAAiC,8B,wCAGnCJ,mBAAA,cAAiB,EACNC,QAAA,CAAAI,OAAO,I,cAAlBR,mBAAA,CAGM,OAHNS,UAGM,G,0BAFJP,mBAAA,CAAgB,YAAZ,SAAO,qBACXA,mBAAA,CAAwB,aAAAQ,gBAAA,CAAhBN,QAAA,CAAAI,OAAO,iB,wCAGjBL,mBAAA,UAAa,EACFQ,IAAA,CAAAC,KAAK,I,cAAhBZ,mBAAA,CAEM,OAFNa,UAEM,GADJX,mBAAA,CAAkB,WAAAQ,gBAAA,CAAZC,IAAA,CAAAC,KAAK,iB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}